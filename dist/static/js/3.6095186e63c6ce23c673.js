webpackJsonp([3],{AtsS:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o("mvHQ"),a=o.n(s),l={name:"UserMain",data:function(){return{isCollapse:!0,activeName:"first",userInfo:{},imgFileList:[],dialogTableVisible:!1,dialogFormVisible:!1,dialogWorksVisible:!1,checkedId:"",loginType:"",dialogImageUrl:"",dialogVisible2:!1,form:{},worksFrom:{},options2:[{value:1,label:"自然"},{value:2,label:"地理"},{value:3,label:"美学"},{value:4,label:"科技"}],passwordChange:{userName:"",password:"",newPassword:""},tableData:[],options:[{value:1,label:"男"},{value:2,label:"女"}]}},methods:{handleOpen:function(e,t){},dialogClose:function(){this.imgFileList=[]},handleClick:function(e,t){},handleRemove:function(e,t){},onSuccess:function(e,t,o){this.form.fileUrl=e,this.fileList=[]},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible2=!0},showWorks:function(e){console.log(e),this.dialogWorksVisible=!0,this.checkedId=e.id,this.worksFrom=e,this.dialogImageUrl=e.fileUrl;var t=new Object;t.url=e.fileUrl,this.imgFileList.push(t),console.log(this.fileList)},changePassword:function(){var e=this;this.$axios.post("/user/changePassword",{id:window.localStorage.getItem("userId"),loginAccount:this.passwordChange.loginAccount,password:this.passwordChange.password,newPassword:this.passwordChange.newPassword}).then(function(t){t.data?(e.$message({message:"修改成功！",type:"success"}),localStorage.removeItem("user"),e.$router.push("/login")):e.$message.error("密码错误")}).catch(function(e){})},createWorks:function(){var e=this;this.$axios.post("/works/updateWorks",{id:this.checkedId,fileUrl:this.worksFrom.fileUrl,modifyId:JSON.parse(window.localStorage.getItem("user")).id,modifyName:JSON.parse(window.localStorage.getItem("user")).userName,worksDesc:this.worksFrom.worksDesc,worksName:this.worksFrom.worksName,type:this.worksFrom.type}).then(function(t){200==t.status?(e.$message("上传作品成功"),e.dialogWorksVisible=!1):e.$message({message:"上传作品失败！",type:"error"})}).catch(function(e){})},getInfo:function(){var e=this;this.$axios.get("/user/getInfo?userId="+window.localStorage.getItem("userId"),{}).then(function(t){window.localStorage.setItem("user",a()(t.data)),e.userInfo=t.data,e.loginType=t.data.type}).catch(function(e){})},getWorks:function(){var e=this;this.$axios.get("/works/getWorksByUser?createId="+window.localStorage.getItem("userId"),{}).then(function(t){e.tableData=t.data}).catch(function(e){})},submitForm:function(){var e=this;this.$axios.post("/user/changeInfo",{id:this.userInfo.id,userName:this.userInfo.userName,phoneNum:this.userInfo.phoneNum,age:this.userInfo.age,gender:this.userInfo.gender}).then(function(t){e.getInfo(),e.dialogFormVisible=!1}).catch(function(e){})}},mounted:function(){this.getInfo(),this.getWorks()}},i={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-tabs",{attrs:{type:"border-card"}},[o("el-tab-pane",[o("span",{attrs:{slot:"label"},slot:"label"},[e._v(" 个人信息")]),e._v(" "),o("el-card",{staticClass:"box-card",staticStyle:{width:"80%",height:"500px","margin-left":"100px"}},[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("修改个人信息")])],1),e._v(" "),o("div",{staticClass:"text item",staticStyle:{"margin-top":"50px","font-size":"20px","margin-left":"230px"}},[e._v("\n          用户名："+e._s(e.userInfo.userName)+"\n        ")]),e._v(" "),o("div",{staticClass:"text item",staticStyle:{"font-size":"20px","margin-left":"230px"}},[e._v("联系电话："+e._s(e.userInfo.phoneNum))]),e._v(" "),o("div",{staticClass:"text item",staticStyle:{"font-size":"20px","margin-left":"230px"}},[e._v("年龄："+e._s(e.userInfo.age))]),e._v(" "),o("div",{staticClass:"text item",staticStyle:{"font-size":"20px","margin-left":"230px"}},[e._v("性别："+e._s(1==e.userInfo.gender?"男":"女"))]),e._v(" "),o("div",{staticClass:"text item",staticStyle:{"font-size":"20px","margin-left":"230px"}},[e._v("状态："+e._s(1==e.userInfo.status?"有效":"冻结"))]),e._v(" "),o("div",{staticClass:"text item",staticStyle:{"font-size":"20px","margin-left":"230px"}},[e._v("\n          类别："+e._s(1==e.userInfo.type?"用户":2==e.userInfo.type?"管理员":"评委")+"\n        ")]),e._v(" "),3==e.userInfo.type?o("div",{staticClass:"text item",staticStyle:{"font-size":"20px","margin-left":"230px"}},[e._v("职称："+e._s(e.userInfo.level))]):e._e()])],1),e._v(" "),o("el-tab-pane",{attrs:{label:"密码修改"}},[o("el-form",{staticStyle:{width:"35%","margin-left":"200px"},attrs:{"label-position":e.labelPosition,"label-width":"80px",model:e.passwordChange,align:"center"}},[o("el-form-item",{staticStyle:{"margin-top":"80px"},attrs:{label:"登陆账号"}},[o("el-input",{model:{value:e.passwordChange.loginAccount,callback:function(t){e.$set(e.passwordChange,"loginAccount",t)},expression:"passwordChange.loginAccount"}})],1),e._v(" "),o("el-form-item",{staticStyle:{"margin-top":"80px"},attrs:{label:"旧密码"}},[o("el-input",{attrs:{type:"password"},model:{value:e.passwordChange.password,callback:function(t){e.$set(e.passwordChange,"password",t)},expression:"passwordChange.password"}})],1),e._v(" "),o("el-form-item",{staticStyle:{"margin-top":"80px"},attrs:{label:"新密码"}},[o("el-input",{attrs:{type:"password"},model:{value:e.passwordChange.newPassword,callback:function(t){e.$set(e.passwordChange,"newPassword",t)},expression:"passwordChange.newPassword"}})],1),e._v(" "),o("el-form-item",{staticStyle:{"margin-top":"80px"}},[o("el-button",{attrs:{type:"primary"},on:{click:e.changePassword}},[e._v("修改")])],1)],1)],1),e._v(" "),1===e.loginType?o("el-tab-pane",{staticStyle:{height:"500px"},attrs:{label:"我的作品"}},[o("el-table",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.load,expression:"load"}],staticStyle:{width:"100%","margin-left":"200px",overflow:"auto"},attrs:{data:e.tableData,height:"400"}},[o("el-table-column",{attrs:{prop:"worksName",label:"作品名",width:"300"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"作品",width:"400"},scopedSlots:e._u([{key:"default",fn:function(e){return[o("img",{attrs:{src:e.row.fileUrl,alt:"错误",height:"100px",width:"100px"}})]}}],null,!1,186948453)}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(o){return e.showWorks(t.row)}}},[e._v("编辑")])]}}],null,!1,950019723)})],1)],1):e._e()],1),e._v(" "),o("el-dialog",{attrs:{title:"修改个人信息",visible:e.dialogFormVisible,"modal-append-to-body":!1,width:"500px",center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[o("el-form",{ref:"form",attrs:{model:e.userInfo,"label-width":"110px"}},[o("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[o("el-input",{staticStyle:{width:"auto"},attrs:{autocomplete:"off"},model:{value:e.userInfo.userName,callback:function(t){e.$set(e.userInfo,"userName",t)},expression:"userInfo.userName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"年龄",prop:"age"}},[o("el-input",{staticStyle:{width:"auto"},attrs:{type:"number",autocomplete:"off"},model:{value:e.userInfo.age,callback:function(t){e.$set(e.userInfo,"age",t)},expression:"userInfo.age"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"联系电话",prop:"phoneNum"}},[o("el-input",{staticStyle:{width:"auto"},attrs:{autocomplete:"off"},model:{value:e.userInfo.phoneNum,callback:function(t){e.$set(e.userInfo,"phoneNum",t)},expression:"userInfo.phoneNum"}})],1),e._v(" "),3==e.userInfo.type?o("el-form-item",{attrs:{label:"职称",prop:"level"}},[o("el-input",{staticStyle:{width:"auto"},attrs:{autocomplete:"off"},model:{value:e.userInfo.level,callback:function(t){e.$set(e.userInfo,"level",t)},expression:"userInfo.level"}})],1):e._e(),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"gender"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.userInfo.gender,callback:function(t){e.$set(e.userInfo,"gender",t)},expression:"userInfo.gender"}},e._l(e.options,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),3==e.userInfo.type?o("el-form-item",{attrs:{label:"专业"}},[o("el-select",{staticStyle:{width:"auto"},attrs:{placeholder:"请选择专业类型"},model:{value:e.userInfo.profession,callback:function(t){e.$set(e.userInfo,"profession",t)},expression:"userInfo.profession"}},[o("el-option",{attrs:{label:"理论",value:"1"}}),e._v(" "),o("el-option",{attrs:{label:"新闻",value:"2"}}),e._v(" "),o("el-option",{attrs:{label:"出版",value:"3"}}),e._v(" "),o("el-option",{attrs:{label:"文艺",value:"4"}}),e._v(" "),o("el-option",{attrs:{label:"文化经营管理",value:"5"}})],1)],1):e._e()],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"上传新作品",visible:e.dialogWorksVisible,"modal-append-to-body":!1,width:"500px",center:""},on:{"update:visible":function(t){e.dialogWorksVisible=t},close:e.dialogClose}},[o("el-form",{attrs:{"label-width":"110px"},model:{value:e.worksFrom,callback:function(t){e.worksFrom=t},expression:"worksFrom"}},[o("el-form-item",{attrs:{label:"作品名",prop:"worksName"}},[o("el-input",{staticStyle:{width:"auto"},attrs:{autocomplete:"off"},model:{value:e.worksFrom.worksName,callback:function(t){e.$set(e.worksFrom,"worksName",t)},expression:"worksFrom.worksName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"上传图片(单次一张)",prop:"fileUrl"}},[o("el-upload",{attrs:{action:"http://47.103.29.16:8081/works/upload","list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove,"on-success":e.onSuccess,"file-list":e.imgFileList,accept:"png;jpg;jpeg;",limit:1},model:{value:e.worksFrom.fileUrl,callback:function(t){e.$set(e.worksFrom,"fileUrl",t)},expression:"worksFrom.fileUrl"}},[o("i",{staticClass:"el-icon-plus"})]),e._v(" "),o("el-dialog",{attrs:{visible:e.dialogVisible2},on:{"update:visible":function(t){e.dialogVisible2=t}}},[o("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),e._v(" "),o("el-form-item",{attrs:{label:"作品类型",prop:"type"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.worksFrom.type,callback:function(t){e.$set(e.worksFrom,"type",t)},expression:"worksFrom.type"}},e._l(e.options2,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),o("el-form-item",{attrs:{label:"作品介绍",prop:"worksDesc"}},[o("el-input",{staticStyle:{width:"200px"},attrs:{type:"textarea",autosize:{minRows:4,maxRows:6},placeholder:"请输入内容",autocomplete:"off"},model:{value:e.worksFrom.worksDesc,callback:function(t){e.$set(e.worksFrom,"worksDesc",t)},expression:"worksFrom.worksDesc"}})],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogWorksVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.createWorks}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var r=o("VU/8")(l,i,!1,function(e){o("oK1w")},"data-v-9bead07e",null);t.default=r.exports},oK1w:function(e,t){}});
//# sourceMappingURL=3.6095186e63c6ce23c673.js.map